Pentesting 
Konfiguracja połączenia sieciowego External w Hyper-V
Cel: Przełączenie połączenia sieciowego na External w Hyper-V dla maszyny wirtualnej z Kali Linux. To pozwala na bezpośrednie korzystanie z fizycznej karty sieciowej hosta, unikając konfliktów z innymi VPN-ami.
Kroki:
Otwórz Hyper-V Manager:
Uruchom Hyper-V Manager na swojej maszynie hosta.
Stwórz nowy Virtual Switch:
Przejdź do opcji Virtual Switch Manager po prawej stronie ekranu.
Wybierz New virtual network switch, a następnie zaznacz External jako typ połączenia.
Kliknij Create Virtual Switch.
Skonfiguruj Virtual Switch:
W polu Name, nadaj nazwę swojemu nowemu przełącznikowi, np. "ExternalSwitch".
W sekcji Connection type, wybierz External network i wybierz fizyczną kartę sieciową hosta z listy dostępnych adapterów.
Zaznacz opcję Allow management operating system to share this network adapter, jeśli chcesz, aby maszyna hosta mogła nadal korzystać z tego adaptera.
Kliknij OK, aby zapisać zmiany.
Przypisz Virtual Switch do maszyny wirtualnej:
W Hyper-V Manager, znajdź swoją maszynę wirtualną z Kali Linux, kliknij prawym przyciskiem myszy na nazwę maszyny i wybierz Settings.
W menu po lewej, przejdź do sekcji Network Adapter.
W sekcji Virtual switch, wybierz nowo utworzony ExternalSwitch z listy dostępnych opcji.
Kliknij OK, aby zapisać zmiany.
Uruchom maszynę wirtualną i sprawdź połączenie:
Uruchom swoją maszynę wirtualną z Kali Linux.
Sprawdź, czy masz połączenie sieciowe, wpisując w terminalu:

Bash
"
ip a
"

Powinieneś zobaczyć przypisany adres IP z sieci lokalnej.
Połącz się z OpenVPN na Kali Linux:
Jeśli masz już plik konfiguracyjny (.ovpn) z TryHackMe, uruchom OpenVPN:

Bash
"
sudo openvpn --config /path/to/your/config.ovpn
"

Połącz się z siecią TryHackMe i sprawdź połączenie.
Wnioski: Przełączenie połączenia sieciowego na External w Hyper-V umożliwia stabilne i niezależne połączenie z siecią zewnętrzną. Dzięki temu możesz uniknąć potencjalnych konfliktów z innymi VPN-ami, zachowując pełną kontrolę nad trasowaniem sieci na maszynie wirtualnej.

OWASP Juice Shop 
https://demo.owasp-juice.shop/#/search 
Strona do nauki szukania podatności w aplikacjach webowych. Napisana w całości w nowoczesny sposób zawiera mnóstwo podatności. Jest to aplikacja dostępna online, czyli pracować może na niej wiele osób jednocześnie. Mogą być drobne problemy z działaniem tej aplikacji. Nie zawsze dostajemy, przecież czyste środowisko do działania. Narzędzie Burp Suite służy do modifakcji i przechwytywania zapytań http, https oraz modyfikacji ich w prosty sposób. Możliwość testowania szybkiego różnych podatności. Korzystać należy z proxy. Skaner, w tej aplikacji poszukuje różnych plików i sprawdza jakie można znaleźć zasoby dotyczące danej aplikacji. Wykonujemy symulowany atak man-in-the-middle. My jesteśmy jako proxy między przeglądarką, a aplikacją na serwerze. Proxy podłączamy w Firefox. Można sprawdzać, co się wydarzy jeżeli wyślemy zapytanie na niestniejącego użytkownika. Ale, jeśli zwracana odpowiedź jest identyczna jak w przypadku istniejącego użytkownika i błędnego hasła. To nie sprawdzimy w ten sposób, czy ten użytkownik istnieje w bazie, czy nie. Ale np.. Przy opcji forgot your password może być do wpisania odpowiedź na pytanie, jeżeli użytkownik istnieje i np.. Brak pytania, jeżeli użytkownika w ogóle nie ma w bazei aplikacji. Pole hasło najczęściej jest hashowane.  
 
https://medium.com/@corybantic/tryhackme-owasp-juice-shop-walkthrough-ab07d12dbdc#id_token=eyJhbGciOiJSUzI1NiIsImtpZCI6ImQyZDQ0NGNmOGM1ZTNhZTgzODZkNjZhMTNhMzE2OTc2YWEzNjk5OTEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiIyMTYyOTYwMzU4MzQtazFrNnFlMDYwczJ0cDJhMmphbTRsamRjbXMwMHN0dGcuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJhdWQiOiIyMTYyOTYwMzU4MzQtazFrNnFlMDYwczJ0cDJhMmphbTRsamRjbXMwMHN0dGcuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJzdWIiOiIxMTUzNTQ4NzU3MjY5MTg1MzA2NjEiLCJlbWFpbCI6Im1hdGlzYXJub3dza2k4OEBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmJmIjoxNzIzNzM0MzE3LCJuYW1lIjoiTWF0ZXVzeiBTYXJub3dza2kiLCJwaWN0dXJlIjoiaHR0cHM6Ly9saDMuZ29vZ2xldXNlcmNvbnRlbnQuY29tL2EvQUNnOG9jSy16b002OG9xYzBUTVk5Vzl5R050TEFhUXJKdFFWaE9BY1FqMG5MVlljcTYyM0h3UE9nQT1zOTYtYyIsImdpdmVuX25hbWUiOiJNYXRldXN6IiwiZmFtaWx5X25hbWUiOiJTYXJub3dza2kiLCJpYXQiOjE3MjM3MzQ2MTcsImV4cCI6MTcyMzczODIxNywianRpIjoiMGE0NWVhZDhmNWU3NTA1YTMwNTc2MjgyNjQxMGIyM2VjYzJkYTE1ZCJ9.nWbNPhRrvPJkDKOImk0kWZQ41uLmCSfl4tgXiiWsn3VaKObE6wCqV1p9aXOtxzMH-tL-HNNQUxsP9OtGw2VNcu0IopDrN08YLCTuz_FCtzbRbyV_2VIWIlgIbbhhICvvp_zW6ekhJuM2NCcViCcehkAQ0yLAT4Ub28BLL9KDfssK6jN61vQY3MXeaRIsC-vyb2T7vjhfov8dwAGnD5VjhzNILf5YAeMdKZnrSRCcMex__zOeL4Y-LR4sPzpKsEiekmR5s2n3GabI3oU4QY7cAxAAjyeIs-n_cpeuS2oC9jVoW1efLdMeeFlvU6uTnC2xDg2QcBnTcNpQSxgif081EQ 
 
TryHackMe: OWASP Juice Shop — Przewodnik 
Autor: CoryBantic NSP Security 
CoryBantic NSP Security 
· 
7 minut czytania 
· 
14 czerwca 2023 
TLDR: To jest przewodnik po OWASP Juice Shop na platformie TryHackMe. Zawiera zrzuty ekranu, moje metody oraz odpowiedzi. 
Przewodnik ten jest przeznaczony dla tych, którzy nie mają własnych maszyn wirtualnych i chcą skorzystać z tego, co oferuje TryHackMe. Przed rozpoczęciem tego pokoju zaleca się ukończenie pokoi: 
• Web Fundamentals 
• Burpsuite Basics 
• Burpsuite Repeater 
Wszystko gotowe? Zaczynajmy. 
ZADANIE 1: OTWARCIE BIZNESU 
Juice Shop to duża aplikacja, więc nie obejmują całego OWASP Top 10, ale pokrywają te pięć tematów: 
• Iniekcja 
• Złamane uwierzytelnianie 
• Ekspozycja wrażliwych danych 
• Złamana kontrola dostępu 
• Cross-Site Scripting (XSS) 
Pytania 
Uruchom maszynę wirtualną przypisaną do tego zadania, aby rozpocząć! Możesz uzyskać dostęp do tej maszyny za pomocą przeglądarki, lub jeśli jesteś połączony przez OpenVPN. 
Odpowiedź: Nie wymaga odpowiedzi 
Gdy maszyna zostanie załadowana, uzyskaj do niej dostęp, kopiując i wklejając jej adres IP do przeglądarki; jeśli korzystasz z przeglądarki na tej maszynie, wklej adres IP maszyny do przeglądarki. 
Odpowiedź: Nie wymaga odpowiedzi 
ZADANIE 2: Wyruszamy na przygodę! 
Zanim przejdziemy do części związanej z hackowaniem, warto się rozejrzeć. W BurpSuite ustaw tryb Intercept na wyłączony i przeglądaj stronę. Pozwoli to BurpSuite na rejestrowanie różnych żądań z serwera, które mogą być przydatne później. 
To się nazywa przeglądanie aplikacji, co jest również formą rozpoznania! 
Po prostu przejrzyj wszystko i zobacz, czy coś się wyróżnia. Kliknąłem na pierwszy produkt, którym był sok jabłkowy, i od razu zobaczyłem recenzję pozostawioną przez admin@juice-sh.op. To odpowiada na pierwsze pytanie. 
Pytanie #1: Jaki jest adres e-mail administratora? 
Odpowiedź: admin@juice-sh.op 
Kliknięcie na lupę w prawym górnym rogu aplikacji wywoła pasek wyszukiwania. 
Możemy teraz wpisać tekst, a po naciśnięciu Enter aplikacja wyszuka wprowadzone frazy. 
Zwróć teraz uwagę na URL, który zaktualizuje się o wpisany tekst. 
Teraz możemy zobaczyć parametr wyszukiwania po /#/search?, a następnie literę q. 
Pytanie #2: Jaki parametr jest używany do wyszukiwania? 
Odpowiedź: q 
Pytanie #3: Na jaki program odnosi się Jim w swojej recenzji? 
Jim napisał recenzję na temat produktu Green Smoothie. Widzimy, że wspomina o "replicator". 
Jeśli wyguglujemy "replicator", otrzymamy wyniki wskazujące, że pochodzi to z programu telewizyjnego "Star Trek". 
Odpowiedź: Star Trek 
ZADANIE 3: Iniekcja soku 
To może być trochę mylące, jak to zrobić. Musisz otworzyć BurpSuite. Nie musisz zmieniać żadnych ustawień ani aktualizować niczego w tym celu. 
Pierwsze pytanie dotyczy zalogowania się na konto administratora. Możemy już znać adres e-mail (może admin@juice-sh.op), ale nie znamy hasła. Upewnij się, że BurpSuite jest aktywne i tryb Intercept jest włączony przed próbą logowania. 
Po próbie zalogowania powinieneś otrzymać flagę. 
Teraz zalogujemy się na bender@juice-sh.op w ten sam sposób. Hasło nie ma znaczenia. 
Po wysłaniu powinieneś otrzymać flagę. 
Odpowiedz na poniższe pytania 
Pytanie #1: Zaloguj się na konto administratora! 
Po nawigacji na stronę logowania, wpisz jakieś dane w pola e-mail i hasło. 
Przed kliknięciem "Wyślij", upewnij się, że tryb Intercept jest włączony. 
Pozwoli nam to zobaczyć dane wysyłane do serwera! 
Zmienimy teraz „a” obok adresu e-mail na: ' or 1=1 -- i przekażemy to do serwera. 
Dlaczego to działa? 
• Znak ' zamyka nawiasy w zapytaniu SQL. 
• OR w zapytaniu SQL zwróci wartość prawda, jeśli którakolwiek ze stron będzie prawdziwa. Ponieważ 1=1 jest zawsze prawdą, całe zapytanie będzie prawdziwe. W związku z tym serwer uzna, że e-mail jest prawidłowy i zaloguje nas na identyfikator użytkownika 0, którym jest konto administratora. 
• Znak -- jest używany w SQL do komentowania danych, co sprawia, że wszelkie ograniczenia logowania nie działają, ponieważ są traktowane jako komentarz. To podobne do # i // w Pythonie i JavaScript. 
Odpowiedź: 32a5e0f21372bcc1000a6088b93b458e41f0e02a 
Pytanie #2: Zaloguj się na konto Bendera! 
Podobnie jak w pytaniu #1, teraz zalogujemy się na konto Bendera! Przechwyć ponownie żądanie logowania, ale tym razem wpisz: bender@juice-sh.op’ -- jako adres e-mail. 
Następnie przekaż to do serwera! 
Dlaczego nie używamy 1=1? 
Cóż, ponieważ adres e-mail jest prawidłowy (co zwróci prawdę), nie musimy go wymuszać. Dlatego możemy użyć ' -- do ominięcia systemu logowania. Zwróć uwagę, że 1=1 można użyć, gdy adres e-mail lub nazwa użytkownika są nieznane lub nieprawidłowe. 
Odpowiedź: fb364762a3c102b2db932069c0e6b78e738d4066 
ZADANIE 4: Kto zepsuł mój zamek?! 
Pytania 
Przejdź do BurpSuite i aktywuj kartę ‘Intruder’. Przejdź do ‘Positions’, a następnie wybierz przycisk ‘Clear §’. 
Pytanie #1: Bruteforce hasło konta administratora! 
Użyliśmy SQL Injection do zalogowania się na konto administratora, ale nadal nie znamy hasła. Spróbujmy ataku brute-force! Ponownie przechwycimy żądanie logowania, ale zamiast przesyłać je przez proxy, wyślemy je do Intruder. 
Przejdź do ‘Positions’, a następnie wybierz przycisk ‘Clear §’. W polu hasła umieść dwa § w cudzysłowie. Aby to wyjaśnić, § § to nie dwa oddzielne wejścia, ale raczej implementacja cudzysłowów Burpa, np. “”`. Żądanie powinno wyglądać jak na poniższym obrazku. 
Dla ładunku użyjemy best1050.txt z Seclists. (Można go zainstalować za pomocą: apt-get install seclists). Możesz załadować listę z /usr/share/seclists/Passwords/Common-Credentials/best1050.txt. 
UWAGA: Używałem Attacker Box i miałem problemy z poprzednim krokiem. apt-get install seclists nie zadziałał i powyższy katalog nie istniał. Znalazłem lokalizację: /root/Tools/wordlists/SecLists/Passwords/Common-Credentials/best1050.txt. 
Powinieneś wybrać następujący plik Runtime jako typ ładunku. 
Po załadowaniu pliku do Burp, rozpocznij atak. Chcesz przefiltrować żądania według statusu. Nieudane żądanie otrzyma status 401 Unauthorized, natomiast udane żądanie zwróci 200 OK. 
Znaleźliśmy hasło. Teraz zaloguj się na konto z hasłem. 
Odpowiedź: c211 
Odpowiedź: c2110d06dc6f81c67cd8099ff0ba601241f1ac0e 
Pytanie #2: Zresetuj hasło Jima! 
Uwierz lub nie, mechanizm resetowania hasła również można wykorzystać! Po wprowadzeniu adresu e-mail na stronie "Zapomniałem hasła", pytanie bezpieczeństwa Jima jest ustawione na: "Imię drugiego rodzeństwa?". 
Uwaga: Adres e-mail Jima to jim@juice-sh.op 
W Zadaniu 2 odkryliśmy, że Jim może mieć coś wspólnego z "Star Trek". Wyszukiwanie w Google hasła "Jim Star Trek" daje nam stronę wiki dla Jamesa T. Kirka ze Star Treka. Przeglądając stronę wiki, dowiadujemy się, że ma on brata. Wygląda na to, że środkowe imię jego brata to Samuel. 
Wprowadzenie tego imienia na stronie "Zapomniałem hasła" pozwala na pomyślne zresetowanie hasła. Możesz zmienić je na dowolne. 
Odpowiedź: 094fbc9b48e525150ba97d05b942bbf114987257 
Dalsze zadania 
Więcej informacji pojawi się wkrótce. Niestety, w tej chwili mam problemy z Burpsuite w tym pokoju. Gdy tylko rozwiążę problem, powrócę do tego przewodnika. 
• Zadanie 5: AH! Nie patrz! 
• Zadanie 6: Kto to pilotuje? 
• Zadanie 7: Skąd to się wzięło? 
• Zadanie 8: Eksploracja! 


1. Wprowadzenie do testowania bezpieczeństwa aplikacji
Testowanie bezpieczeństwa aplikacji, znane również jako pentesting, to proces identyfikacji podatności i luk w zabezpieczeniach aplikacji. Celem tych działań jest zabezpieczenie aplikacji przed potencjalnymi zagrożeniami poprzez wykrycie i naprawienie słabych punktów, zanim zostaną one wykorzystane przez złośliwe podmioty.
2. Kluczowe etapy w procesie testowania bezpieczeństwa
	• Reconnaissance (Rozpoznanie):
		• Passive Reconnaissance: Gromadzenie danych o aplikacji bez bezpośredniego kontaktu z celem, np. poprzez analizę domen, rejestrów DNS, czy wyszukiwanie informacji w sieci.
		• Active Reconnaissance: Bezpośrednie skanowanie i analiza aplikacji przy użyciu narzędzi takich jak Nmap czy Shodan w celu wykrycia otwartych portów i dostępnych usług.
	• Skanowanie podatności:
		• Automatyczne skanery: Narzędzia takie jak Nessus, OpenVAS, OWASP ZAP, które automatycznie wykrywają podatności w aplikacjach i infrastrukturze.
		• Ręczne testowanie: Manualne testy prowadzone przez pentesterów w celu wykrycia bardziej złożonych podatności, często trudnych do zidentyfikowania przez automatyczne skanery.
	• Eksploatacja podatności:
		• SQL Injection: Wprowadzanie złośliwych zapytań SQL, aby uzyskać dostęp do danych lub przejąć kontrolę nad aplikacją.
		• Cross-Site Scripting (XSS): Ataki polegające na wstrzykiwaniu złośliwego kodu do aplikacji, który jest następnie wykonywany w przeglądarkach użytkowników.
		• Cross-Site Request Forgery (CSRF): Przejęcie kontroli nad działaniami użytkownika poprzez manipulację jego sesją.
	• Testowanie mechanizmów uwierzytelniania:
		• Brute Force: Automatyczne próby odgadnięcia haseł poprzez testowanie dużej liczby kombinacji.
		• Session Hijacking: Przejęcie aktywnej sesji użytkownika poprzez kradzież jego tokenu sesji.
3. Narzędzia i techniki stosowane w testowaniu bezpieczeństwa
	• Burp Suite: Kompleksowe narzędzie do testowania bezpieczeństwa aplikacji webowych, umożliwiające zarówno automatyczne, jak i ręczne testy, w tym przeglądanie aplikacji, analizę ruchu sieciowego, skanowanie podatności oraz przeprowadzanie ataków typu brute force.
	• OWASP ZAP: Popularne narzędzie do skanowania aplikacji webowych, znane z wykrywania szerokiego spektrum podatności, w tym XSS, SQL Injection i wielu innych.
	• Nmap: Narzędzie do skanowania sieci i wykrywania otwartych portów oraz usług działających na docelowej maszynie, często wykorzystywane w fazie rozpoznania.
4. Przykłady ataków i eksploatacji podatności
	• SQL Injection: Użytkownik może uzyskać nieautoryzowany dostęp do bazy danych, wprowadzając specjalnie sformułowane zapytania SQL w polach formularzy.
	• XSS (Cross-Site Scripting): Atakujący może wstrzyknąć złośliwy kod JavaScript, który zostanie wykonany w przeglądarce innego użytkownika, co może prowadzić do kradzieży danych sesyjnych lub przejęcia konta.
	• CSRF (Cross-Site Request Forgery): Atakujący może zmusić zalogowanego użytkownika do wykonania nieautoryzowanych działań, na przykład zmiany hasła lub przelania środków na konto atakującego.
5. Znaczenie dokumentacji i raportowania
	Po zakończeniu testów bezpieczeństwa wszystkie odkryte podatności powinny być szczegółowo udokumentowane. Raporty powinny zawierać opisy znalezionych luk, potencjalne skutki ich wykorzystania, kroki podjęte podczas testowania oraz zalecenia dotyczące naprawy.

